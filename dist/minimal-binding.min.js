!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Auditor=e()}(this,function(){"use strict";function t(t){return null!==t&&"object"===(void 0===t?"undefined":i(t))}function e(t){return Array.isArray(t)}function r(t,e,r,n){Object.defineProperty(t,e,{value:r,enumerable:!!n,writable:!0,configurable:!0})}function n(t){function e(t){if(!t.__arrayMutationIntercepted)if(t.__arrayMutationIntercepted=!0,c)t.__proto__=o;else for(var e=(Object.getOwnPropertyNames(o),0),n=keys.length;e<n;e++){var a=keys[e];r(t,a,o[a])}}var n=Array.prototype,o=Object.create(n);return["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(e){var a=n[e];r(o,e,function(){for(var e=arguments,r=arguments.length,n=new Array(r);r--;)n[r]=e[r];var o=this.length,i=a.apply(this,n);return t(this,this.__auditor,this.__path),this.__auditor._propertyChanged({property:this.__path,oldValue:o,newValue:i}),i})}),{interceptingMutatorMethods:e}}function o(e){function r(r,n){var o=Object.getOwnPropertyDescriptor(r,n);if(!o||!1!==o.configurable){var a=r[n];if(t(a)){if(a.__objectMutationIntercepted)return;a.__objectMutationIntercepted=!0}var i=o&&o.set,u=o&&o.get,c=r.__path?r.__path+"."+n:n;Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:function(){return u?u.call(r):a},set:function(t){var n=u?u.call(r):a;t!==n&&(i?i.call(r,t):a=t,e(t,r.__auditor,r.__path),r.__auditor._propertyChanged({property:c,oldValue:n,newValue:t}))}})}}return{interceptingMutatorMethods:r}}function a(){function r(r,n,o){t(r)&&(r.__auditor=n,r.__path=o,e(r)?i(r):a(r))}function a(t){for(var e=Object.keys(t),n=0;n<e.length;n++){var o=e[n],a=t[e[n]];if(!o.startsWith("__")){c.interceptingMutatorMethods(t,o);var i=t.__path?t.__path+"."+o:o;r(a,t.__auditor,i)}}}function i(t){u.interceptingMutatorMethods(t);for(var e=0,n=t.length;e<n;e++)r(t[e],t.__auditor,t.__path+"["+e+"]")}var u=new n(r),c=new o(r);return{traverse:r}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c="__proto__"in{};return function t(e){u(this,t);var r=void 0;if(e.__auditor)r=e.__auditor;else{r=this,r._target=e,r._callbacks=[],r._propertyChanged=function(t){r._callbacks.forEach(function(e){e(t)})},r.onPropertyChanged=function(t){"function"==typeof t&&r._callbacks.push(t)};(new a).traverse(e,r)}}});